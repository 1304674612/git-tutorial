name: Check Documentation Links

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  schedule:
    # æ¯å‘¨æ£€æŸ¥ä¸€æ¬¡é“¾æ¥
    - cron: '0 0 * * 0'

jobs:
  check-links:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v5
    
    - name: Check links in documentation
      uses: lycheeverse/lychee-action@v1
      with:
        args: --verbose --no-progress './**/*.md'
        fail: true
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    
    - name: Create issue on link failure
      if: failure()
      uses: actions/github-script@v7
      with:
        script: |
          github.rest.issues.create({
            owner: context.repo.owner,
            repo: context.repo.repo,
            title: 'ğŸ“ å‘ç°å¤±æ•ˆé“¾æ¥ - Broken Links Detected',
            body: 'è‡ªåŠ¨æ£€æµ‹å‘ç°æ–‡æ¡£ä¸­å­˜åœ¨å¤±æ•ˆé“¾æ¥ï¼Œè¯·æ£€æŸ¥å¹¶ä¿®å¤ã€‚\n\nAutomatic link checking found broken links in documentation. Please review and fix.',
            labels: ['bug', 'documentation']
          })